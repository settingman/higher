<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <title>더현대닷컴</title>


    <link rel="stylesheet" type="text/css" href="https://image.thehyundai.com/pc/cssssl/co.css?ver=23">
    <link rel="stylesheet" type="text/css" href="https://image.thehyundai.com/pc/cssssl/wf.css">
    <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script>
    <script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=UA-69960332-7&amp;l=dataLayer&amp;cx=c"></script>
    <script src="https://image.thehyundai.com/pc/js/jquery-1.11.3.min.js"></script>
    <script src="https://image.thehyundai.com/pc/js/jquery-ui.min.js"></script>
    <script src="https://image.thehyundai.com/pc/js/jquery-migrate.min.js"></script>


    <script src="https://image.thehyundai.com/pc/js/plugin.js?ver=030123"></script>
    <script type="text/javascript" src="https://image.thehyundai.com/pc/js/hdmall/co/jquery.form.js"></script>
    <script type="text/javascript" src="https://image.thehyundai.com/pc/js/hdmall/co/default.js?ver=030123"></script>
    <script type="text/javascript" src="https://image.thehyundai.com/pc/js/hdmall/co/common.js?ver=030123"></script>
    <script src="https://image.thehyundai.com/pc/js/common.js?ver=030123"></script>
    <script type="text/javascript" src="https://image.thehyundai.com/pc/js/swiper.min.js?ver=030123"></script>



    <link rel="stylesheet" type="text/css" href="https://www.thehyundai.com/cssssl/jquery-ui.css?ver=23">
    <link rel="stylesheet" type="text/css" href="https://www.thehyundai.com/cssssl/od.css?ver=23">
    <link rel="stylesheet" type="text/css" href="https://www.thehyundai.com/cssssl/dp.css?ver=23">
    <!-- 	<script src="https://www.thehyundai.com/js/cart.js?ver=030123"></script>
 -->
    <script src="/js/cart/cart.js"></script>

    <script type="text/javascript">
        var _gaPageTitle = "장바구니";

        $(function() {
            $(".cart-list-wrap input[name='checkbox_all']").iCheck("check");

            // 2020 카드즉시할인 icheck 뒤로가기시 이벤트 오류 항상체크로 변경
            window.onpageshow = function(e) {
                // 2023.01.13 DEP01WORK-25674 장바구니 버그 수정 
                var checkedList = $('div.icheckbox'); // onpageshow 이벤트 발생전, icheck event 발생가능하여, 사전 체크된 데이터 확인
                $('input.type-green').attr('checked', false); // 기존 체크된거 disable처리.
                $('input.type-green').prop('checked', false);
                $.each(checkedList, function(i, obj) {
                    // 체크 된것만 체크 처리
                    if ($(obj).hasClass('checked')) {
                        $(obj).children('input.type-green').attr('checked', true);
                        $(obj).children('input.type-green').prop('checked', true);
                    }
                });
                calcSellPrc();
            };

            // 체크박스 변경시 결제금액 재계산 처리
            $(".cart-list-wrap div.icheckbox").on("ifChanged", function() {
                // 결제금액 계산
                calcSellPrc();
            });

            $(document).on("click", ".opt-select-box:not(.opened) .opt-select-value a", function(e) {
                e.preventDefault();
                // 옵션 선택창 활성화
                $(this).parents(".opt-select-box").toggleClass("current");
                // 옵션 첫번째 단계활성화
                $(this).parents(".opt-select-box").find(".opt-select-layer li:first-child").addClass("current");
                // class="current"

                return false;
            });

            $(document).on("click", ".opt-select-layer a.depth-menu", function(e) {
                e.preventDefault();
                $index = $(this).parent("li").index();

                // 선행 옵션을 선택하지 않으면 선택할수 없다.
                if ($(this).parent().prev().length > 0 && !$(this).parent().prev().find(".depth-menu").hasClass("selected")) {
                    alert("위의 정보를 먼저 선택해주세요!");
                    return false;
                }

                $(this).parents(".opt-select-layer").children("li").each(function(idx, elm) {
                    if (idx >= $index) {
                        $(this).removeClass("selected")
                            .siblings(".depth-opt-list li").removeClass(".current")
                            .end().find("input[name=uitmSeq]").val("")
                            .end().find(".depth-menu").removeClass("selected")
                            .end().find(".selected-opt").text("");
                        if (idx > 0) {
                            $(this).find(".depth-opt-list").children("li").each(function() {
                                $(this).remove();
                            });
                        }
                    }
                });

                // 아니면 다른 단계의 선택을 모두 제거하고 해당 단계부터 옵션을 다시 선택한다.
                $(this).parent().siblings("li").removeClass("current").end().addClass("current");

                return false;
            });


            $(document).on("click", ".depth-opt-list a.selectUitmAttrType2", function(e) {
                e.preventDefault();
                // 상품속성코드 클리어
                $("#productModifyForm input[name=newUitmCd]").val("");

                // 선택된 옵션의 이름
                $val = $(this).find(".opt-name").text();

                // 해당 옵션 부모에 선택된 값 넣기.
                $(this).parents(".depth-opt-list").siblings(".depth-menu").find(".selected-opt").text($val)
                    .end().addClass("selected").parent("li").removeClass("current")
                    .next().addClass("current");

                $("#productModifyForm input[name=newUitmCd]").val($(this).attr("value"));

                var last_opt_value = "";
                $(this).parents(".opt-select-layer").find(".depth-menu").each(function() {
                    if (last_opt_value.length > 0) {
                        last_opt_value += " / "
                    }
                    last_opt_value += $(this).find(".selected-opt").text();

                });

                last_opt_value += '<i class="icon-arrow opt-toggle"></i>';
                $(this).parents(".opt-select-box").find(".opt-select-value a").html(last_opt_value);
                // 옵션 모두 선택됨. 초기화
                option_reset($(this).parents(".opt-select-layer"));

                return false;
            });



            $(document).on("click", ".depth-opt-list a.selectUitmAttrType", function(e) {
                e.preventDefault();
                $("#productModifyForm input[name=newUitmCd]").val("");

                // 선택된 옵션의 이름
                $val = $(this).find(".opt-name").text();

                $currIndex = $(this).parents(".depth-opt-list").parent("li").index();
                $lastidx = $(this).parents(".opt-select-layer").children("li").length;

                var slitmCd = $("#productModifyForm input[name='slitmCd']").val();
                var bsitmCd = $("#productModifyForm input[name='bsitmCd']").val();
                var uitmAttrTypeSeq = $(this).parents(".opt-select-layer").find("input[name='uitmAttrTypeSeq']:eq(" + (Number($currIndex) + 1) + ")").val();

                if (uitmAttrTypeSeq == undefined || uitmAttrTypeSeq == "undefined") {
                    uitmAttrTypeSeq = $(this).parents(".opt-select-layer").find("input[name='uitmAttrTypeSeq']:eq(" + Number($currIndex) + ")").val();
                }

                // 해당 옵션 부모에 선택된 값 넣기.
                $(this).parents(".depth-opt-list").siblings("input[name=uitmSeq]").val($(this).attr("value"));
                $(this).parents(".depth-opt-list").siblings(".depth-menu").find(".selected-opt").text($val)
                    .end().addClass("selected").parent("li").removeClass("current")
                    .next().addClass("current");

                $(this).parents(".opt-select-layer").children("li").each(function(idx, elm) {
                    if (idx > $currIndex) {
                        $(this).removeClass("selected")
                            .siblings(".depth-opt-list li").removeClass(".current")
                            .end().find("input[name=uitmSeq]").val("")
                            .end().find(".depth-menu").removeClass("selected")
                            .end().find(".selected-opt").text("");
                    }
                });

                var last_opt_value = "";
                var uitmSeqArrParam = new Array();
                $(this).parents(".opt-select-layer").find(".depth-menu").each(function() {
                    if (last_opt_value.length > 0) {
                        last_opt_value += " / "
                    }
                    last_opt_value += $(this).find(".selected-opt").text();
                    uitmSeqArrParam.push($(this).siblings("input[name=uitmSeq]").val());
                });

                if ($currIndex == $lastidx - 1) {

                    last_opt_value += '<i class="icon-arrow opt-toggle"></i>';
                    $(this).parents(".opt-select-box").find(".opt-select-value a").html(last_opt_value);

                    // 상품속성코드 조회
                    $.ajax({
                        type: "post",
                        url: "/front/mpa/selectUitmCd.thd?uitmSeqArr=" + uitmSeqArrParam.join("&uitmSeqArr="),
                        dataType: "json",
                        data: {
                            slitmCd: slitmCd,
                            bsitmCd: bsitmCd,
                            uitmAttrTypeSeq: uitmAttrTypeSeq
                        },
                        success: function(data) {
                            $("#productModifyForm input[name=newUitmCd]").val(data.newUitmCd);
                        },
                        error: function(data) {
                            alert("시스템 오류입니다. 다시 시도해주세요.");
                        }
                    });

                    // 옵션 모두 선택됨. 초기화
                    option_reset($(this).parents(".opt-select-layer"));

                    return;
                }

                /*
                 * 선택한 속성에 따른 다음 속성 값 조회 후 select 셋팅
                 */
                $.ajax({
                    type: "post",
                    url: "/front/pda/selectUitmAttrListForChangeSelect.thd?uitmSeqArr=" + uitmSeqArrParam.join("&uitmSeqArr="),
                    dataType: "json",
                    data: {
                        slitmCd: slitmCd,
                        bsitmCd: bsitmCd,
                        uitmAttrTypeSeq: uitmAttrTypeSeq
                    },
                    success: function(data) {
                        if (data.uitmList) {
                            var prevUitmSeq = "";
                            for (var i in data.uitmList) {
                                if (data.uitmList[i].uitmAttrTypeSeq == uitmAttrTypeSeq) {
                                    if (prevUitmSeq != data.uitmList[i].uitmSeq) {
                                        prevUitmSeq = data.uitmList[i].uitmSeq;
                                        $(".opt-select-layer").find(".depth-opt-list:eq(" + (Number($currIndex) + 1) + ")").append('<li><a href="#" value="' + data.uitmList[i].uitmSeq + '" class="selectUitmAttrType"><span class="opt-name">' + data.uitmList[i].uitmAttrNm + '</span></a></li>');
                                    }
                                }
                            }
                        }
                    },
                    error: function(data) {
                        alert("시스템 오류입니다. 다시 시도해주세요.");
                    }
                });

                return false;

            });


        });

        function option_reset(obj) {
            $(obj).children("li").each(function(idx, elm) {
                $(this).find(".depth-menu").removeClass("selected")
                    .end().siblings(".depth-opt-list li").removeClass(".current")
                    .end().find(".selected-opt").text("");

                if (idx > 0) {
                    $(this).find(".depth-opt-list").children("li").each(function() {
                        $(this).remove();
                    });
                }

            });
            $(obj).parents(".opt-select-box").toggleClass("current");
            if ($(obj).parents(".opt-select-box").hasClass("fixed")) $(obj).parents(".opt-select-box").find(".opt-select-layer").children("li").first().addClass("current");
        }

        function initCartBody() {
            /* 장바구니에서 가격 변경 박스 닫기 버튼 동작*/
            $(".change-infobox a.close").on("click", function(e) {
                /* 동작요청에 따라 remove or hide */
                $(this).parents("tr").removeClass("has-change-infobox");
                $(this).parents(".change-infobox-wrap").remove();
                return false
            });

            // 장바구니 좌측 체크박스 스타일링 & 클릭 영역 확장
            $(".cart-list-wrap input").iCheck({
                increaseArea: '40%'
            });

            $(".cart-list-wrap input[name='checkbox_all']").on("ifChanged", function() {
                //https://github.com/fronteed/iCheck 레퍼런스는 여기로
                if ($(this).prop("checked")) $(".cart-list-wrap input[name='" + $(this).val() + "']").iCheck("check");
                else $(".cart-list-wrap input[name='" + $(this).val() + "']").iCheck("uncheck");
            });

            $('select[name="select_date"]').on('selectric-change', function(element) {
                change_date($(this));
            });

            // 체크박스 변경시 결제금액 재계산 처리
            $(".cart-list-wrap div.icheckbox").on("ifChanged", function() {
                // 결제금액 계산
                cal();
                calcSellPrc();
            });

            /**
             * 숫자만 입력가능
             */
            $("input.onlyNumberInput").keydown(function(event) {
                // Allow: backspace, delete, tab, escape, enter and .
                if ($.inArray(event.keyCode, [46, 8, 9, 27, 13, 190]) !== -1 ||
                    // Allow: Ctrl+A
                    (event.keyCode == 65 && event.ctrlKey === true) ||
                    // Allow: home, end, left, right
                    (event.keyCode >= 35 && event.keyCode <= 39)) {
                    // let it happen, don't do  anything
                    return;
                } else {
                    // Ensure that it is a number and stop the keypress
                    if (event.shiftKey || (event.keyCode < 48 || (event.keyCode > 57 && event.keyCode < 96) || event.keyCode > 105)) {
                        event.preventDefault();
                    }
                }
            });
        }
        $(document).ready(function() {
            calcSellPrc();
        });


        // 탭 변경
        function changeTab(basktTypeGbcd) {

            if ($("div.tab-block") != undefined && ("div.tab-block") != "undefined") {

                $("div.tab-block").find("li").each(function() {
                    if ($(this).attr("tabid") == basktTypeGbcd) {
                        $(this).addClass("active");
                    } else {
                        $(this).removeClass("active");
                    }
                });
            }

            var targetId = "cart-tab-" + basktTypeGbcd;
            $(document).find(".cart-list-wrap").each(function() {
                if ($(this).attr("id") == targetId) {
                    $(this).addClass("active");
                } else {
                    $(this).removeClass("active");

                    $(".cart-list-wrap input[name='checkbox_all']").each(function() {
                        if ("checkbox" + basktTypeGbcd != $(this).val()) {
                            $(this).iCheck("check");
                        }
                    });

                    $("div.cart-cont-wrap").find("li").each(function() {
                        if ($(this).attr("tabid") == basktTypeGbcd) {
                            // 체크박스처리
                            if ($("div.cart-list-wrap.active h4.blind")) {
                                var cart_list = $("div.cart-list-wrap.active h4.blind").parent();
                                $(cart_list).find("div.cart-list-cont").each(function() {
                                    $(this).find("input[name='checkbox" + basktTypeGbcd + "']").iCheck("check");
                                });
                            }
                        }
                    });
                }
            });
            fnAside_scroll();
            calcSellPrc();
        }


        function calcSellPrc() {
            var hpoint = 0;
            var deposit = 0;
            var totProdPrc = 0;
            var totBbprcPrc = 0;
            var totDlvCost = 0;
            var basktBndlList = new Array();
            var basktEmptyBndlList = new Array();

            if ($("div.cart-list-wrap.active").attr("id") != null) {
                var typeGb = $("div.cart-list-wrap.active").attr("id").substring(9);
                if ($("div.cart-list-wrap.active h4.blind")) {
                    var cart_list = $("div.cart-list-wrap.active h4.blind").parent();
                    var tempBndlKey = "";
                    var idx = -1;
                    $(cart_list).find("div.cart-list-cont").each(function() {
                        if ($(this).find("input[name='checkbox" + typeGb + "']").prop("checked")) {
                            if (!isNaN(Number($(this).find("input[name='prodPrc']").val()))) {
                                totProdPrc += Number($(this).find("input[name='prodPrc']").val());
                            }
                            if (!isNaN(Number($(this).find("input[name='bbprcPrc']").val()))) {
                                totBbprcPrc += Number($(this).find("input[name='bbprcPrc']").val());
                            }
                            var prodPrc = $(this).find("input[name='prodPrc']").val();
                            var dlvcPayGbcd = $(this).find("input[name='dlvcPayGbcd']").val();
                            var prpyDlvCost = $(this).find("input[name='prpyDlvCost']").val();
                            var sdlvcMinStlmAmt = $(this).find("input[name='sdlvcMinStlmAmt']").val();
                            var sdlvcDlvCost = $(this).find("input[name='sdlvcDlvCost']").val();
                            var dptsDlvMinStlmAmt = $(this).find("input[name='dptsDlvMinStlmAmt']").val();
                            var baseDlvCost = $(this).find("input[name='baseDlvCost']").val();
                            var basktBndlInfo = {
                                prodPrc: prodPrc,
                                dlvcPayGbcd: dlvcPayGbcd,
                                prpyDlvCost: prpyDlvCost,
                                sdlvcMinStlmAmt: sdlvcMinStlmAmt,
                                sdlvcDlvCost: sdlvcDlvCost,
                                dptsDlvMinStlmAmt: dptsDlvMinStlmAmt,
                                baseDlvCost: baseDlvCost
                            };
                            var basktBndlKey = $(this).find("input[name='basktBndlKey']").val();
                            if (basktBndlKey != null && basktBndlKey != "") {
                                if (tempBndlKey != basktBndlKey) {
                                    idx++;
                                    tempBndlKey = basktBndlKey;
                                    basktBndlList[idx] = {
                                        basktBndlKey: basktBndlKey,
                                        basktBndlArr: new Array()
                                    };
                                }
                                basktBndlList[idx].basktBndlArr[basktBndlList[idx].basktBndlArr.length] = basktBndlInfo;
                            } else {
                                basktEmptyBndlList[basktEmptyBndlList.length] = basktBndlInfo;
                            }
                        }
                    });

                    if (basktEmptyBndlList.length > 0) {
                        for (var i = 0; i < basktEmptyBndlList.length; i++) {
                            idx++;
                            basktBndlList[idx] = {
                                basktBndlKey: '',
                                basktBndlArr: new Array()
                            };
                            basktBndlList[idx].basktBndlArr[basktBndlList[idx].basktBndlArr.length] = basktEmptyBndlList[i];
                        }
                    }
                }

                // 배송비 계산
                if (typeGb != "02") { // 스토어픽상품이 아닌 경우만 배송비 계산
                    if (basktBndlList.length > 0) {
                        for (var i = 0; i < basktBndlList.length; i++) {
                            var dlvCost = 0; // 배송비
                            var totItemAmt = 0; // 총상품 금액
                            var freeDlvYn = false; // 무료배송상품 포함여부
                            var arpayYn = false; // 착불배송 포함여부
                            var dptsDlvMinStlmAmt;
                            var baseDlvCost;
                            var minStlmAmt;
                            var venDlvCost;
                            for (var idx = 0; idx < basktBndlList[i].basktBndlArr.length; idx++) {
                                var prodPrc = basktBndlList[i].basktBndlArr[idx].prodPrc;
                                var dlvcPayGbcd = basktBndlList[i].basktBndlArr[idx].dlvcPayGbcd;
                                var sdlvcDlvCost = isNaN(Number(basktBndlList[i].basktBndlArr[idx].sdlvcDlvCost)) ? 0 : Number(basktBndlList[i].basktBndlArr[idx].sdlvcDlvCost);
                                venDlvCost = sdlvcDlvCost;
                                minStlmAmt = basktBndlList[i].basktBndlArr[idx].sdlvcMinStlmAmt;
                                dptsDlvMinStlmAmt = basktBndlList[i].basktBndlArr[idx].dptsDlvMinStlmAmt;
                                baseDlvCost = basktBndlList[i].basktBndlArr[idx].baseDlvCost;

                                totItemAmt += Number(prodPrc);
                                //배송비 계산
                                var freeDlvItemYn = false;
                                if (!arpayYn) {
                                    // 1순위 : 착불배송
                                    if (dlvcPayGbcd == "20" || dlvcPayGbcd == "30") {
                                        arpayYn = true;
                                    }
                                }

                                if (dlvcPayGbcd == "00") { // 무료배송 상품
                                    freeDlvYn = true;
                                    freeDlvItemYn = true;
                                    dlvCost = 0;
                                } else {
                                    var prpyDlvCost = isNaN(Number(basktBndlList[i].basktBndlArr[idx].prpyDlvCost)) ? 0 : Number(basktBndlList[i].basktBndlArr[idx].prpyDlvCost);
                                    if (dlvCost == 0) {
                                        dlvCost = prpyDlvCost; // 배송비 셋팅
                                    } else if (dlvCost < prpyDlvCost) { // 더 큰 배송비 적용
                                        dlvCost = prpyDlvCost;
                                    }
                                }

                                var bsicItemAmt = 0;
                                if (!freeDlvItemYn) {
                                    // 2순위 : 협력사 소액배송비 조회(장바구니가 배송 기준으로 묶여 있기때문에 묶음의 판매상품코드 중 하나로 조회가능함)
                                    if (basktBndlList[i].basktBndlArr[idx].sdlvcMinStlmAmt != null && basktBndlList[i].basktBndlArr[idx].sdlvcMinStlmAmt != "") {
                                        bsicItemAmt = Number(basktBndlList[i].basktBndlArr[idx].sdlvcMinStlmAmt); // 기준금액
                                        if (Number(prodPrc) < bsicItemAmt) {
                                            if (sdlvcDlvCost == 0) {
                                                dlvCost = dlvCost == 0 ? Number(baseDlvCost) : dlvCost;
                                            } else {
                                                if (dlvCost < sdlvcDlvCost) {
                                                    dlvCost = sdlvcDlvCost;
                                                }
                                            }
                                        } else {
                                            dlvCost = 0;
                                            freeDlvYn = true;
                                            freeDlvItemYn = true;
                                        }
                                    } else {
                                        // 3순위 (3만원미만 2,500원)
                                        bsicItemAmt = Number(dptsDlvMinStlmAmt);
                                        if (Number(prodPrc) < bsicItemAmt) {
                                            dlvCost = (dlvCost == 0 || dlvCost < Number(baseDlvCost)) ? Number(baseDlvCost) : dlvCost;
                                        } else {
                                            freeDlvYn = true;
                                            freeDlvItemYn = true;
                                            dlvCost = 0;
                                        }
                                    }
                                }
                            }
                            var sdlvcVenDtl;
                            if (minStlmAmt != null && minStlmAmt != "") {
                                sdlvcVenDtl = {
                                    minStlmAmt: minStlmAmt,
                                    dlvCost: venDlvCost
                                };
                            }

                            // 배송비 계산
                            var bsicAmt = 0; // 기준금액
                            if (!freeDlvYn) {
                                // 2순위 : 협력사 소액배송비 조회(장바구니가 배송 기준으로 묶여 있기때문에 묶음의 판매상품코드 중 하나로 조회가능함)
                                if (sdlvcVenDtl != null) {
                                    bsicAmt = Number(sdlvcVenDtl.minStlmAmt); // 기준금액
                                    if (totItemAmt < bsicAmt) {
                                        if (sdlvcVenDtl.dlvCost > 0) {
                                            if (dlvCost < sdlvcVenDtl.dlvCost) {
                                                dlvCost = sdlvcVenDtl.dlvCost;
                                            }
                                        } else {
                                            dlvCost = (dlvCost == 0 || dlvCost < Number(baseDlvCost)) ? Number(baseDlvCost) : dlvCost;
                                        }
                                    } else {
                                        dlvCost = 0;
                                        freeDlvYn = true;
                                    }
                                } else {
                                    // 3순위 : (3만원 미만 2,500원)
                                    bsicAmt = Number(dptsDlvMinStlmAmt);
                                    if (totItemAmt < bsicAmt) {
                                        dlvCost = (dlvCost == 0 || dlvCost < Number(baseDlvCost)) ? Number(baseDlvCost) : dlvCost;
                                    } else {
                                        freeDlvYn = true;
                                        dlvCost = 0;
                                    }
                                }
                            }

                            if (freeDlvYn || arpayYn) {
                                dlvCost = 0;
                            }
                            //배송비 계산
                            totDlvCost += dlvCost;
                        }
                    }
                }

                if (!isNaN(Number($("input[name='hpoint']").val()))) {
                    hpoint = Number($("input[name='hpoint']").val());
                }

                if (!isNaN(Number($("input[name='deposit']").val()))) {
                    deposit = Number($("input[name='deposit']").val());
                }

                $("#totOrdPrc").text(gfn_appendComma(totProdPrc + totDlvCost));

                $("#totProdPrc").text(gfn_appendComma(totProdPrc));

                if (totDlvCost > 0) {
                    $("#totDlvCost").text(gfn_appendComma(totDlvCost) + " 원");
                } else {
                    $("#totDlvCost").text("무료");
                }

                $("#totDiscntPrc").text(gfn_appendComma(totBbprcPrc));
                $("#totbbprcPrc").text(gfn_appendComma(totBbprcPrc));

                var totPayPrc = totProdPrc + totDlvCost - totBbprcPrc;
                $("#payPrc").text(gfn_appendComma(totPayPrc));


                var payHpoint = 0;
                var payDeposit = 0;

                if (totPayPrc > hpoint) {
                    if (hpoint > 0) {
                        payHpoint = hpoint;
                        if ((totPayPrc - hpoint) <= deposit) {
                            payDeposit = (totPayPrc - hpoint);
                        } else {
                            payDeposit = deposit;
                        }
                    } else {
                        if (totPayPrc <= deposit) {
                            payDeposit = totPayPrc;
                        } else {
                            payDeposit = deposit;
                        }
                    }
                } else {

                    payHpoint = totPayPrc;
                }
            }

            var totPayPrc = totPayPrc - payHpoint - payDeposit;

            $("#totPayPrc").text(gfn_appendComma(totPayPrc));
        }



        function plusOrdQty(obj, pcode, poption, cindex) {


            var input = $(obj).siblings("input[name='cnt']");
            var ordQty = Number($(input).val());

            var limitCnt = 99;

            if (ordQty >= limitCnt) {
                alert("여러 고객님들에게 구매 기회를 드리기 위해 동일 상품은 일일 " + limitCnt + "개로 구매가 제한됩니다. 고객 여러분들의 양해 부탁드립니다.");
                return;
            }

            $(input).val(ordQty + 1);

            var requestData = JSON.stringify({
                pcode: pcode,
                poption: poption,
                pamount: $(input).val()
            });

            console.log("---" + requestData);

            $.ajax({
                url: '/restcart/modifyAmount',
                type: 'post',
                data: requestData,
                contentType: "application/json",
                success: function(result) {
                    console.log("장바구니 수량 변경 success");

                    var bbprc = parseFloat($("#" + cindex + " input[name='bbprc']").val());
                    console.log(bbprc + "-----------");
                    var new_price = bbprc * $(input).val();
                    $("#" + cindex + " .o-price").text(new_price.toLocaleString() + "원");
                    $("#" + cindex + " input[name='prodPrc']").val(new_price);
                    $("#" + cindex + " .tot-price").text(new_price.toLocaleString() + "원");
                    cal();
                    loadingBar.stop();

                },
                error: function(request, status, error) {
                    console.log(error);
                }
            });

            //modifyOrdQty(slitmCd, uitmCd, basktTypeGbcd, $(input).val(), ordQty, obj);
        }


        function minusOrdQty(obj, pcode, poption, cindex) {
            // loadingBar.start();

            var input = $(obj).siblings("input[name='cnt']");
            var ordQty = Number($(input).val());

            if (ordQty <= 1) {
                return;
            }

            $(input).val(ordQty - 1);

            var requestData = JSON.stringify({
                pcode: pcode,
                poption: poption,
                pamount: $(input).val()
            });

            console.log("---" + requestData);

            $.ajax({
                url: '/restcart/modifyAmount',
                type: 'post',
                data: requestData,
                contentType: "application/json",
                success: function(result) {
                    console.log("장바구니 수량 변경 success");

                    var bbprc = parseFloat($("#" + cindex + " input[name='bbprc']").val());
                    console.log(bbprc + "-----------");
                    var new_price = bbprc * $(input).val();
                    $("#" + cindex + " .o-price").text(new_price.toLocaleString() + "원");
                    $("#" + cindex + " input[name='prodPrc']").val(new_price);
                    $("#" + cindex + " .tot-price").text(new_price.toLocaleString() + "원");
                    cal();
                    loadingBar.stop();

                },
                error: function(request, status, error) {
                    console.log(error);
                }
            });

            //modifyOrdQty(slitmCd, uitmCd, basktTypeGbcd, $(input).val(), ordQty, obj);
        }

        function cal() {
            let liList = document.querySelectorAll(".cart-list-unit");
            let totOrdPrc = 0;
            let totProdPrc = 0;
            let payPrc = 0;
            for (let i = 0; i < liList.length; i++) {
                if ($(liList[i]).find('.icheckbox').hasClass('checked')) {

                    var prodPrc = $(liList[i]).find("input[name='prodPrc']").val();
                    // let prodPrc = parseInt(liList[i].querySelector(".prodPrc"));
                    console.log(prodPrc + "----");
                    totOrdPrc += parseInt(prodPrc);
                    totProdPrc += parseInt(prodPrc);
                }
            }
            payPrc = totProdPrc;
            // let totO = document.getElementById("totOrdPrc");
            // totO.textContent = payPrc.toLocaleString();
            // let totP = document.getElementById("totProdPrc");
            // totP.textContent = payPrc.toLocaleString();
            // let spanElement = document.getElementById("payPrc");
            // spanElement.textContent = payPrc.toLocaleString();

            console.log(`totOrdPrc: ${totOrdPrc}원, totProdPrc: ${totProdPrc}원, payPrc: ${payPrc}원`);

            // let first = document.getElementById("totOrdprc");
            // first.innerText = payPrc.toLocaleString;
            // let second = document.getElementById("totOrdprc");
            // second.innerText = payPrc.toLocaleString;
            // let third = document.getElementById("totOrdprc");
            // third.innerText = payPrc.toLocaleString;
            $("#totOrdPrc").text(gfn_appendComma(payPrc));
            $("#totProdPrc").text(gfn_appendComma(payPrc));
            $("#payPrc").text(gfn_appendComma(payPrc));

            // document.getElementById("totOrdPrc").innerText = payPrc.toLocaleString();
            // document.getElementById("totProdPrc").innerText = payPrc.toLocaleString();
            // document.getElementById("payPrc").innerText = payPrc.toLocaleString();

        }




        // function modifyOrdQty(slitmCd, uitmCd, basktTypeGbcd, ordQty, oldOrdQty, obj) {
        // 	console.log("상품 수량 변경");
        // 	loadingBar.start();


        // 	}


        function deleteBaskt(obj, targetObj, delType) {

            //버튼이 눌렸을 때
            let liList = document.querySelectorAll(".cart-list-unit");
            console.log("-------");
            let pcodeTest = $("#c0").find(".check-group").children("#pcode").val();
            console.log(pcodeTest);
            var arr = new Array();
            var checked = new Array();


            for (let i = 0; i < liList.length; i++) {
                console.log("-----------");

                if ($(liList[i]).find('.icheckbox').hasClass('checked')) {
                    const pcode = $(liList[i]).find('#pcode').val();
                    console.log(pcode);
                    const poption = $(liList[i]).find('.cnt-opt').text();
                    console.log("option" + poption);
                    arr.push({
                        pcode: pcode,
                        poption: poption
                    });
                    checked.push("c" + i);
                }

            }

            $.ajax({
                url: '/restcart/deleteCarts', // 서버 측에서 정의한 URL 주소
                type: 'post',
                data: JSON.stringify(arr),
                contentType: "application/json",

                success: function(result) {
                    console.log("장바구니 선택 삭제 success");

                    for (let i = 0; i < checked.length; i++) {
                        const li = document.getElementById(checked[i]);
                        li.remove();
                        cal();
                        if ($(liList[i]).find('.icheckbox').hasClass('checked')) {

                        }

                    }
                },
                error: function(request, status, error) {
                    console.log(error);
                    // 처리 중 에러가 발생한 경우에 실행할 코드 작성
                }
            });
            /* 	    success: function (result) {
							console.log("장바구니 선택 삭제 success");
							
							// const li = document.getElementById(cindex);

							// li.remove();
							// cal();
								
						},
						error :function(request, status, error) {
							console.log(error);
						}
					});   */


        }


        function deleteBasktItem(pcode, poption, cindex) {
            if (!confirm("삭제하시겠습니까?")) {
                return false;
            }

            var requestData = JSON.stringify({
                pcode: pcode,
                poption: poption,
            });

            console.log("---" + requestData);

            $.ajax({
                url: '/restcart/deleteCart',
                type: 'post',
                data: requestData,
                contentType: "application/json",
                success: function(result) {
                    console.log("장바구니 삭제 success");

                    const li = document.getElementById(cindex);

                    li.remove();
                    cal();

                },
                error: function(request, status, error) {
                    console.log(error);
                }
            });


          

        }



        function imdtCrdDcChk(obj) {
            var typeGb = $("div.cart-list-wrap.active").attr("id").substring(9);
            var cart_list = $("div.cart-list-wrap.active h4.blind").parent();
            var chkOrderCnt = 0;
            var imdtCrdDcZero = 0;

            var basktInfArr = new Array();
            var ordAgreeInfArr = new Array();
            var imdtCrdDcSetArr = new Array();
            var ordAgreeImg = new Array();
            var imdtCrdDcArr = new Array();

            var equalCrdDcBoolean = true;

            //체크된 상품 각각 0, 즉 비대상인 경우에 카운트 체크
            $(cart_list).find("input[name='checkbox" + typeGb + "']:checked").each(function(index, subObj) {
                chkOrderCnt++; //체크된 상품 카운트
                if ($(subObj).parent().parent().parent().find("input[name='imdtCrdDcCnt']").val() == "0") {
                    imdtCrdDcZero++;
                }

                basktInfArr.push($(subObj).val());
                ordAgreeInfArr.push($(subObj).parent().parent().parent().find("input[name='ordAgreeInf']").val());
                ordAgreeImg.push($(subObj).parent().parent().parent().find("div.prod-info div.img img").attr("src"));

                //할인카드 셋팅
                $(subObj).parent().parent().parent().find("input[name='imdtCrdDcSet']").each(function(idx, value) {
                    imdtCrdDcSetArr.push($(this).val());
                });
            });

            //할인카드 중복값 제거
            if (imdtCrdDcSetArr.length > 0) {
                $.each(imdtCrdDcSetArr, function(idx, value) {
                    if ($.inArray(value, imdtCrdDcArr) == -1) {
                        imdtCrdDcArr.push(value);
                    }
                });
            }

            if (imdtCrdDcArr.length > 0) {
                for (var i = 0; i < imdtCrdDcArr.length; i++) {
                    var imdtCrdDcSetInf = imdtCrdDcArr[i].split('|');
                    var equalCrdDcCnt = 0;
                    $.each(imdtCrdDcArr, function(idx, value) {
                        if (value.indexOf(imdtCrdDcSetInf[6]) != -1) {
                            equalCrdDcCnt++;
                        }
                    });

                    if (equalCrdDcCnt != chkOrderCnt) {
                        equalCrdDcBoolean = false;
                        break;
                    }
                }
            } else {
                equalCrdDcBoolean = true;
            }

            //비대상이 없는 경우에 주문하기로 이동
            if (imdtCrdDcZero == 0 && equalCrdDcBoolean == true) {
                orderReq();
            } else if (chkOrderCnt == imdtCrdDcZero && equalCrdDcBoolean == true) { //전부 비대상 상품일 경우
                orderReq();
            } else {
                var ordCnt = 0;
                var prmoCrdDcInfo = "";
                for (var i = 0; i < ordAgreeInfArr.length; i++) {
                    var ordAgreeInf = ordAgreeInfArr[i].split('|');
                    ordCnt++;
                    prmoCrdDcInfo += '<li>';
                    prmoCrdDcInfo += '<div class="thum"><a href="#"><img src="' + ordAgreeImg[i] + '"></a></div>';
                    prmoCrdDcInfo += '<div class="cont">';
                    prmoCrdDcInfo += '<p>' + ordAgreeInf[2] + '</p>';
                    prmoCrdDcInfo += '</div>';
                    prmoCrdDcInfo += '<div class="card-msg">';
                    var cardDcCnt = 0;
                    for (var j = 0; j < imdtCrdDcArr.length; j++) {
                        var imdtCrdDcSetInf = imdtCrdDcArr[j].split('|');
                        var dcTotPrice = Number(imdtCrdDcSetInf[4]);
                        var dcStrtPrice = Number(imdtCrdDcSetInf[5]);
                        if (ordAgreeInf[4] == imdtCrdDcSetInf[0]) {
                            //if(dcTotPrice >= dcStrtPrice){
                            prmoCrdDcInfo += '<p> [' + imdtCrdDcSetInf[2] + '] ';

                            if (imdtCrdDcSetInf[1] == '08') {
                                prmoCrdDcInfo += '청구할인';
                            } else {
                                prmoCrdDcInfo += '즉시할인';
                            }

                            prmoCrdDcInfo += imdtCrdDcSetInf[3] + '%</p>';
                            cardDcCnt++;
                            //}
                        }

                        if (j == (imdtCrdDcArr.length - 1)) {
                            if (cardDcCnt == 0) {
                                prmoCrdDcInfo += '<p class="not-card">할인 적용 카드 없음</p>';
                            }
                        }
                    }

                    prmoCrdDcInfo += '</div>';
                    prmoCrdDcInfo += '</li>';
                }

                $("#popover-layer-cardDiscount div.pop-content ul.card-discount-list").html("");
                $("#popover-layer-cardDiscount div.pop-content ul.card-discount-list").html(prmoCrdDcInfo);
                popover_open(obj, '#popover-layer-cardDiscount');
            }
        }


        function orderChkItem(obj) {
            if ($("div.cart-list-wrap.active").attr("id") != null) {
                var typeGb = $("div.cart-list-wrap.active").attr("id").substring(9);


                var chkOrderCnt = 0;
                var imdtCrdDcZero = 0;

                var imdtCrdDcSetArr = new Array();
                var imdtCrdDcArr = new Array();

                var equalCrdDcBoolean = true;

                if ($("div.cart-list-wrap.active h4.blind")) {
                    var cart_list = $("div.cart-list-wrap.active h4.blind").parent();

                    var basktInfArr = new Array();
                    var ordAgreeInfArr = new Array();
                    var ordAgreeImg = new Array();
                    var isStorePickBuy = true;
                    var isSampleProduct = false;

                    var slitmNmArr = new Array();

                    var slitmInfList = new Array();

                    $(cart_list).find("input[name='checkbox" + typeGb + "']:checked").each(function(index, subObj) {
                        basktInfArr.push($(subObj).val());
                        ordAgreeInfArr.push($(subObj).parent().parent().parent().find("input[name='ordAgreeInf']").val());
                        ordAgreeImg.push($(subObj).parent().parent().parent().find("div.prod-info div.img img").attr("src"));

                        slitmNmArr.push($(subObj).parent().parent().parent().find("input[name='slitmNmInf']").val());
                        slitmInfList.push($(subObj).parent().parent().parent().find("input[name='slitmInf']").val());

                        if ($(subObj).parent().parent().parent().find("div.tot-price").text() == '0원') {
                            isSampleProduct = true;
                        }
                        if (typeGb == "02") {
                            var selectPickupDt = $(subObj).parent().parent().parent().find("select[name='selectPickupDt'] option:selected").text();
                            var selectRcvnPlce = $(subObj).parent().parent().parent().find("select[name='selectRcvnPlce'] option:selected").text();
                            if (selectPickupDt.indexOf("불가") > -1 || selectPickupDt.indexOf("휴점") > -1 || selectRcvnPlce.indexOf("불가") > -1) {
                                isStorePickBuy = false;
                            }
                        }


                        chkOrderCnt++;
                        if ($(subObj).parent().parent().parent().find("input[name='imdtCrdDcCnt']").val() == "0") {
                            imdtCrdDcZero++;
                        }

                        //할인카드 셋팅
                        $(subObj).parent().parent().parent().find("input[name='imdtCrdDcSet']").each(function(idx, value) {
                            imdtCrdDcSetArr.push($(this).val());
                        });
                    });

                    var slitmNmList = '';
                    for (var i = 0; i < slitmNmArr.length; i++) {
                        slitmNmList += slitmNmArr[i];
                        if (i != slitmNmArr.length - 1) {
                            slitmNmList += ' / ';
                        }
                    }
                    GA_Event('PC_장바구니', '주문하기', slitmNmList);

                    //할인카드 중복값 제거
                    if (imdtCrdDcSetArr.length > 0) {
                        $.each(imdtCrdDcSetArr, function(idx, value) {
                            if ($.inArray(value, imdtCrdDcArr) == -1) {
                                imdtCrdDcArr.push(value);
                            }
                        });
                    }

                    if (imdtCrdDcArr.length > 0) {
                        for (var i = 0; i < imdtCrdDcArr.length; i++) {
                            var imdtCrdDcSetInf = imdtCrdDcArr[i].split('|');
                            var equalCrdDcCnt = 0;
                            $.each(imdtCrdDcArr, function(idx, value) {
                                if (value.indexOf(imdtCrdDcSetInf[6]) != -1) {
                                    equalCrdDcCnt++;
                                }
                            });

                            if (equalCrdDcCnt != chkOrderCnt) {
                                equalCrdDcBoolean = false;
                                break;
                            }
                        }
                    } else {
                        equalCrdDcBoolean = true;
                    }

                    if (basktInfArr.length == 0) {
                        alert("선택한 상품이 없습니다.");
                        return false;
                    }

                    if (!isStorePickBuy) {
                        alert("선택하신 상품 중 매장과 픽업일이 경과된 상품이 있습니다. 재 설정을 해주세요.");
                        return false;
                    }

                    if (isSampleProduct) {
                        alert("선택하신 상품 중 구매가 불가능 한 샘플 상품(0원)이 있습니다. 주문 목록에서 삭제 후 주문해 주세요.");
                        return false;
                    }

                    $("#tmpBasktForm").html("");
                    for (var i = 0; i < basktInfArr.length; i++) {
                        $("#tmpBasktForm").append('<input type="hidden" name="basktInf" value="' + basktInfArr[i] + '"/>');
                    }
                    for (var i = 0; i < slitmInfList.length; i++) {
                        $("#tmpBasktForm").append('<input type="hidden" name="slitmInf" value="' + slitmInfList[i] + '"/>');
                    }

                    var myMap = new Map();
                    for (var i = 0; i < basktInfArr.length; i++) {
                        var sameItmQty = 0;
                        var basktInfArr2 = basktInfArr[i].split('|'); //40A1436790|00002|01|3|175000|상품명|구매제한수량'
                        if (myMap.size > 0 && myMap.get(basktInfArr2[0]) != null) {
                            sameItmQty = parseInt(myMap.get(basktInfArr2[0]));
                        }

                        if (parseInt(basktInfArr2[3]) + parseInt(sameItmQty) > basktInfArr2[7]) {
                            alert("여러 고객님들에게 구매 기회를 드리기 위해, " + basktInfArr2[6] + "상품은 일일 " + basktInfArr2[7] + "개로 구매가 제한됩니다. 고객 여러분들의 양해 부탁드립니다.");
                            return false;
                        }
                        myMap.set(basktInfArr2[0], parseInt(sameItmQty) + parseInt(basktInfArr2[3]));
                    }

                    var ordMakeCnt = 0;
                    var packOpenRtpNdmtCnt = 0;
                    var ordCnt = 0;
                    var ordBasktInfo = "";
                    for (var i = 0; i < ordAgreeInfArr.length; i++) {
                        var ordAgreeInf = ordAgreeInfArr[i].split('|');
                        var ordMakeYn = ordAgreeInf[0] == null ? "" : ordAgreeInf[0]; // 주문제작
                        var packOpenRtpNdmtYn = ordAgreeInf[1] == null ? "" : ordAgreeInf[1]; // 박스포장
                        if (ordMakeYn == "Y" || packOpenRtpNdmtYn == "Y") {
                            ordCnt++;
                            ordBasktInfo += '<li>';
                            ordBasktInfo += '<div class="thum"><a href="#"><img src="' + ordAgreeImg[i] + '"></a></div>';
                            ordBasktInfo += '<div class="cont">';
                            ordBasktInfo += '<p class="t1">' + ordAgreeInf[2] + '</p>';
                            // ordBasktInfo += '<p class="t1">더현대</p>';
                            // ordBasktInfo += '<p class="t2">(5기획) NEW 헤라 에이지리버스 쿠션세트</p>';
                            ordBasktInfo += '</div>';
                            ordBasktInfo += '</li>';
                        }
                    }

                    if (ordCnt > 0) {
                        $("#popover-layer-buycheck div.pop-content ul.cart-confirm-wrap").html("");
                        $("#popover-layer-buycheck div.pop-content ul.cart-confirm-wrap").html(ordBasktInfo);
                        popover_open(obj, '#popover-layer-buycheck');
                    } else if (imdtCrdDcZero != 0 && equalCrdDcBoolean == false) {
                        imdtCrdDcChk(obj);
                    } else if (chkOrderCnt != imdtCrdDcZero && equalCrdDcBoolean == false) { //전부 비대상 상품일 경우
                        imdtCrdDcChk(obj);
                    } else {
                        orderReq();
                    }
                }
            }
        }



        function checkCmpsOrdQty(obj) {
            var limitCnt = isNaN(Number($(obj).attr("dluMaxBuyQty"))) ? 0 : Number($(obj).attr("dluMaxBuyQty"));
            var qtyChgPossYn = $(obj).attr("plAddBuyNdmtYn");

            // 상품 수랭 변경 불가
            if (qtyChgPossYn == "Y") {
                return;
            }

            var input = $(obj);

            if ($(input).val() == "") {
                $(input).val("0");
            }

            var ordQty = Number($(input).val());

            if (isEmpty(limitCnt) || limitCnt > 99) {
                limitCnt = 99;
            }

            if (ordQty > limitCnt) {
                alert("여러 고객님들에게 구매 기회를 드리기 위해 동일 상품은 일일 " + limitCnt + "개로 구매가 제한됩니다. 고객 여러분들의 양해 부탁드립니다.");
                input.val(limitCnt);
                return;
            }
        }


        function plusCmpsOrdQty(obj) {
            var limitCnt = isNaN(Number($(obj).attr("dluMaxBuyQty"))) ? 0 : Number($(obj).attr("dluMaxBuyQty"));
            var qtyChgPossYn = $(obj).attr("plAddBuyNdmtYn");

            // 상품 수랭 변경 불가
            if (qtyChgPossYn == "Y") {
                return;
            }

            var input = $(obj).siblings("input[name='cmpsOty']");
            var ordQty = Number($(input).val());

            if (isEmpty(limitCnt) || limitCnt > 99) {
                limitCnt = 99;
            }

            if (ordQty >= limitCnt) {
                alert("여러 고객님들에게 구매 기회를 드리기 위해 동일 상품은 일일 " + limitCnt + "개로 구매가 제한됩니다. 고객 여러분들의 양해 부탁드립니다.");
                return;
            }

            $(input).val(ordQty + 1);
        }


        function minusCmpsOrdQty(obj) {
            var limitCnt = isNaN(Number($(obj).attr("dluMaxBuyQty"))) ? 0 : Number($(obj).attr("dluMaxBuyQty"));
            var qtyChgPossYn = $(obj).attr("plAddBuyNdmtYn");

            // 상품 수량 변경 불가
            if (qtyChgPossYn == "Y") {
                return;
            }
            var input = $(obj).siblings("input[name='cmpsOty']");
            var ordQty = Number($(input).val());

            if (ordQty <= 0) {
                return;
            }

            $(input).val(ordQty - 1);
        }


    </script>

    <style type="text/css">
        .fancybox-margin {
            margin-right: 16px;
        }
    </style>

    <link rel="stylesheet" type="text/css" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">


    <style type="text/css">
        .fancybox-margin {
            margin-right: 13px;
        }
    </style>

    <script type="text/javascript" async="" src="https://googleads.g.doubleclick.net/pagead/viewthroughconversion/879261918/?random=1679898029293&amp;cv=11&amp;fst=1679898029293&amp;bg=ffffff&amp;guid=ON&amp;async=1&amp;gtm=45be33m0&amp;u_w=1707&amp;u_h=1067&amp;url=http%3A%2F%2F192.168.137.247%3A5500%2F%25EB%258D%2594%25ED%2598%2584%25EB%258C%2580%25EB%258B%25B7%25EC%25BB%25B4.html&amp;ref=http%3A%2F%2F192.168.137.247%3A5500%2F%25EB%258D%2594%25ED%2598%2584%25EB%258C%2580%25EB%258B%25B7%25EC%25BB%25B4.html&amp;hn=www.googleadservices.com&amp;frm=0&amp;tiba=%EB%8D%94%ED%98%84%EB%8C%80%EB%8B%B7%EC%BB%B4&amp;auid=1184932784.1678862774&amp;data=event%3Dgtag.config&amp;rfmt=3&amp;fmt=4"></script>
</head>

<body>

    <div id="wrap" class="sub notgnb simple-gnb">
        <!-- gnb -->

        <script type="text/javascript" src="https://www.thehyundai.com/js/hdmall/co/referCodes.js"></script>

        <script type="text/javascript" src="https://www.thehyundai.com/static/gen/js/mainBnnrContents.js?ver=012332"></script>

        <!-- 서브메뉴 -->

        <!-- top banner -->
        <div id="js-tpl-topBanner" style="display: none;"></div>


        <script type="text/javascript" src="https://image.thehyundai.com/pc/js/hdmall/co/skyscraper.js?ver=030123"></script>

        <!-- //gnb -->
        <!-- container -->
        <div id="container">
            <h1 class="blind">컨텐츠영역</h1>

            <!-- content-wrap -->
            <div class="content-wrap">

                <!-- cart-head -->
                <div class="cart-head">
                    <h2>장바구니</h2>

                    <div class="stepwrap">
                        <ul>
                            <li>
                                <div class="step-box cart-01 current">
                                    <span class="mark"></span>
                                    <p>STEP 01</p>
                                    <p>장바구니</p>
                                </div>
                            </li>
                            <li><span class="step-mark"></span>
                                <div class="step-box cart-02">
                                    <span class="mark"></span>
                                    <p>STEP 02</p>
                                    <p>주문서작성</p>
                                </div>
                            </li>
                            <li><span class="step-mark"></span>
                                <div class="step-box cart-03">
                                    <span class="mark"></span>
                                    <p>STEP 03</p>
                                    <p>주문완료</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- //cart-head -->

                <!-- cart-body -->
                <div class="cart-body" id="divCartInfo" style="min-height: 863px;">

                    <!-- cart-cont-wrap -->
                    <div class="cart-cont-wrap">

                        <!-- cart-tab cart-list-wrap -->
                        <div class="cart-list-wrap tab-pane active" id="cart-tab-01">
                            <h3 class="blind">일반상품</h3>

                            <!-- cart-list -->

                            <!-- //cart-list -->

                            <h4 class="blind">정상상품</h4>
                            <!-- cart-list-check -->
                            <div class="cart-list-check">
                                <label class="">
                                    <div class="icheckbox allchk checked type-green" style="position: relative;">
                                        <input class="type-green notCRinput" type="checkbox" name="checkbox_all" value="checkbox01" style="position: absolute; top: -40%; left: -40%; display: block; width: 180%; height: 180%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;" checked="checked">
                                    </div> 전체선택
                                </label>
                                <div class="cart-list-check-del">
                                    <a href="javascript:void(0);" onclick="deleteBaskt(this, 'checkbox01', 'SEL');return false;">선택삭제</a>
                                </div>
                            </div>
                            <!-- //cart-list-check -->

                            <!-- cart-list-area -->
                            <div class="cart-list-area">
                                <ul class="cart-list-group">
                                    <li class="cart-list-unit" th:each="carts, state : ${carts}" th:id="c+${state.index}">
                                        <div class="cart-list-cont">
                                            <!-- 체크영역 -->
                                            <div class="check-group">
                                                <div class="icheckbox each checked type-green" style="position: relative;">
                                                    <input class="type-green notCRinput chBox" type="checkbox" name="checkbox01" title="선택" style="position: absolute; top: -40%; left: -40%; display: block; width: 180%; height: 180%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;" checked="checked">
                                                    <ins class="iCheck-helper" style="position: absolute; top: -40%; left: -40%; display: block; width: 180%; height: 180%; margin: 0px; padding: 0px; background: rgb(255, 255, 255); border: 0px; opacity: 0;"></ins>
                                                </div>
                                                <!-- 여기에 보낼 거 넣기 -->



                                                <input type="hidden" id="pcode" th:value="${carts.pcode}">

                                                <button class="btn-list-delete" th:onclick='deleteBasktItem([[${carts.pcode}]],[[${carts.poption}]],"c[[${state.index}]]");'>
                                                    <img src="https://image.thehyundai.com/hdmall/images/co/icon_delete.png" alt="삭제">
                                                </button>
                                            </div>

                                            <!-- 이미지영역 -->
                                            <div class="image-group">
                                                <div class="prod-info">
                                                    <div class="img">
                                                        <a th:href="'/product/detail?code=' + ${carts.pcode}"> <img th:src="${carts.IMAGE_PATH} + '_600.jpg'" onerror="noImage(this, 'https://image.thehyundai.com/hdmall/images/pd/no_image_300x300.jpg')">
                                                        </a>
                                                        <div class="hover-info"></div>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- 상품내용 -->
                                            <div class="cont-group">

                                                <!-- 상품명 -->
                                                <div class="title">
                                                    <a th:href="'/product/detail?code=' + ${carts.pcode}" th:text="${carts.pname}"></a>
                                                </div>

                                                <!-- 각인  -->
                                                <div class="option-stamp"></div>

                                                <!-- 상품옵션 -->
                                                <div class="option-info">
                                                    <p class="cnt-ctrl">
                                                        <a href="javascript:void(0);" class="cnt-up" th:onclick='minusOrdQty(this,[[${carts.pcode}]],[[${carts.poption}]],"c[[${state.index}]]" );'>－</a>
                                                        <input type="text" class="onlyNumberInput" name="cnt" title="inputarea" th:value="${carts.pamount}" style="ime-mode: disabled;" onclick="this.focus();" maxlength="2">
                                                        <a href="javascript:void(0);" class="cnt-down" th:onclick='plusOrdQty(this, [[${carts.pcode}]],[[${carts.poption}]],"c[[${state.index}]]" );'>＋</a>
                                                    </p>

                                                    <p class="cnt-opt">[[${carts.poption}]]</p>

                                                    <select class="form-select form-select-sm" aria-label=".form-select-sm example">
                                                        <option value="${carts.poption}" th:text="${carts.poption}" selected=""></option>
                                                        <option th:each="options, oState : ${carts.optionList}" th:unless="${options.optname} == ${carts.poption}" th:text="${options.optname}"></option>
                                                        <!-- <option selected="">Open this select menu</option>
                                                        <option value="1">One</option>
                                                        <option value="2">Two</option>
                                                        <option value="3">Three</option> -->
                                                    </select>


                                                    <!-- 기본구성 / 추가구성 정보 -->

                                                    <p class="cnt-deliver">
                                                        <span class="deliver"> 30,000원 이상 무료배송 <input type="hidden" name="dlvCost" value="0">
                                                        </span>
                                                    </p>

                                                    <!-- //픽업날짜 변경 pickup-date -->
                                                </div>

                                                <!-- 상품가격 및 버튼 -->
                                                <div class="option-price">
                                                    <div class="price-info">
                                                        <div class="tot-price" th:text="${#numbers.formatInteger(carts.pprice * carts.pamount,3,'COMMA')} + 원"></div>
														<div class="o-price" th:text="${#numbers.formatInteger(carts.pprice* carts.pamount,3,'COMMA')}+원"></div>
														<input type="hidden" name="bbprc" th:value="${carts.pprice}">
														<input type="hidden" name="prodPrc" th:value="${carts.pprice* carts.pamount}" th:data-product_id="${carts.pcode}">
														<input type="hidden" name="bbprcPrc" value="0">
													</div>

													<div class="btn-area">

														<button class="btn size4 color15" type="button"
															onclick="javascript:showChgUitmPup(this, '40A1580453', '00011', '[겔랑] 빠뤼르 골드 스킨 파운데이션 세트', '매트/00C', 131000, '40A1580453','01', 1, 300);return false;"
														>옵션변경</button>

														<button class="btn size4 color4" type="button"
															onclick="javascript:buyDirect(this, 'checkbox01');GA_Event('PC_장바구니', '바로주문', '[겔랑] 빠뤼르 골드 스킨 파운데이션 세트');return false;"
														>바로주문</button>
													</div>
												</div>
											</div>
										</div>
									</li>

								</ul>
							</div>
						</div>
						<!-- //cart-tab cart-list-wrap -->


					</div>
					<!-- //cart-cont-wrap -->
					<!-- cart-aside-wrap -->
					<div class="cart-aside-wrap">

						<!-- billprice-wrap -->
						<div class="billprice-wrap">
							<h3>결제금액</h3>
							<!-- billprice -->
							<ul class="billprice">
								<li>
									<div>
										<h4>총 주문금액</h4>
										<p>
											<strong><span id="totOrdPrc"></span></strong> 원
										</p>
									</div>
									<ul class="sub plus">
										<li>
											<h5>상품금액</h5>
											<p>
												<span id="totProdPrc">321,000</span> 원
											</p>
										</li>
										<li>
											<h5>배송비</h5>
											<p>
												<span id="totDlvCost">무료</span>
											</p>
										</li>
									</ul>
								</li>
								<li>
									<div>
										<h4>총 할인금액</h4>
										<p>
											<strong><span id="totDiscntPrc">0</span></strong> 원
										</p>
									</div>
									<ul class="sub">
										<li>
											<h5>혜택할인가</h5>
											<p>
												-<span id="totbbprcPrc">0</span> 원
											</p>
										</li>
									</ul>
								</li>

								<li class="total">
									<div>
										<h4>결제 예정 금액</h4>
										<p>
											<strong><span id="payPrc">321,000</span></strong> 원
										</p>
									</div>

								</li>
							</ul>
							<!-- //billprice -->
							<p class="attention">* 실제 결제 금액은 할인 및 추가혜택에 따라 달라질 수 있습니다.</p>
							<div class="btn-wrap">
								<a href="javascript:void(0);" class="btn size7 color9 full" onclick="toOrder()">주문하기</a>
							</div>
						</div>
						<!-- //billprice-wrap -->

						<!-- operation-guide -->
						<div class="operation-guide">
							<h4>장바구니 이용안내</h4>
							<ul>
								<li>로그인 시 장바구니에 담긴 상품은 <strong>30일</strong>간 보관됩니다.
								</li>
								<li>상품은 최대 <strong>100개</strong>까지 담을 수 있습니다.
								</li>
							</ul>
						</div>
						<!-- //operation-guide -->

					</div>
					<!-- //cart-aside-wrap -->

				</div>
				<!-- //cart-body -->

			</div>
			<!-- //content-wrap -->

		</div>




<script>
$("select.form-select").on("change", function() {
  var selectedOption = $(this).children("option:selected").val();

	const pcode = this.closest('.cart-list-unit').querySelector('#pcode').value;
    var cnt = $(this).closest(".option-info").children('.cnt-opt');   

	var requestData = JSON.stringify({
							pcode : pcode,
							poption : selectedOption,
					});
					
					console.log("---"+requestData);

					$.ajax({
						url: '/restcart/modifyOption',
						type: 'post',
						data: requestData,
						contentType: "application/json",
						success	: function(result){
							console.log("장바구니 옵션 변경 success"+ selectedOption);

                            cnt.text(selectedOption);

							loadingBar.stop();
								
						},
						error :function(request, status, error) {
							console.log(error);
						}
					}); 

});

</script>

<script>


	$('input[name="checkbox_all"]').click(function(){
	if ($(this).is(':checked')) {
		
		
	$('.cart-list-group li .icheckbox').addClass('checked');
	cal();
	
	$(this).closest('.icheckbox').addClass('checked')
	
	$('.chBox').attr("checked", true);
	
	
	
	} else {
	$('.cart-list-group li .icheckbox').removeClass('checked');
	cal();
	
	$(this).parent('.icheckbox').removeClass('checked')
	
	$('.chBox').attr("checked", false);
	
	}
	
	
	});

	$('.each').click(function(){
		
		if ($(this).hasClass('checked')) {
			
		$(this).removeClass('checked');
		cal();



	$(this).children('.chBox').attr("checked", false);

	console.log($('.chBox').length)
	console.log($('.chBox:checked').length)

	if($('.chBox').length == $('.chBox:checked').length){
		$('.allchk').addClass('checked');
		$('input[name="checkbox_all"]').prop("checked", true);
	}else{
		$('.allchk').removeClass('checked');
		$('input[name="checkbox_all"]').prop("checked", false);
	}


	} else {
		
	$(this).addClass('checked');

	$(this).children('.chBox').attr("checked", true);

	console.log($('.chBox').length)
	console.log($('.chBox:checked').length)


	cal();


	if($('.chBox').length == $('.chBox:checked').length){
		$('.allchk').addClass('checked');
		$('input[name="checkbox_all"]').prop("checked", true);
	}else{
		$('.allchk').removeClass('checked');
		$('input[name="checkbox_all"]').prop("checked", false);
	}



	}
	});
</script>



<script>

// 박성환 
// 주문 페이지 이동.
function toOrder(){
	
	
var confirm_val = confirm("주문하시겠습니까?");
    
    if(confirm_val) {
       
     let idquery = '?pIdList='
     var checkArr = new Array();
    
     var a =  $("input[class='chBox']:checked");
     console.log(a);
     
     
     
 	let liList = document.querySelectorAll(".cart-list-unit");
 	
 	for (let i = 0; i < liList.length; i++) {
		if ($(liList[i]).find('.icheckbox').hasClass('checked')) {
		
			var prodID = $(liList[i]).find("input[name='prodPrc']").data('product_id');
		
		
		
			idquery=idquery + prodID + ','
	      	checkArr.push(prodID);
		
		}
	}
 	
 	
 	
 	idquery = idquery.slice(0, -1);
 	
 	location.href = "/shop/order"+idquery;
     
    } 
   }
</script>
</body>
</html>