<html xmlns:sec="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<head th:insert="~{include/head}"></head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport"
	content="width=device-width,initial-scale=1,maximum-scale=1.0" />
<title>더현대닷컴</title>
<style>
header#header {
	background: none;
	height: auto;
}
</style>
<link rel="stylesheet" type="text/css"
	href="https://image.thehyundai.com/pc/cssssl/font.css" />
<link rel="stylesheet" type="text/css"
	href="/makeup/css/mypage_result.css">
<link rel="stylesheet" type="text/css"
	href="https://image.thehyundai.com/pc/cssssl/co.css?ver=13" />
<link rel="stylesheet" type="text/css"
	href="https://image.thehyundai.com/pc/cssssl/wf.css" />
<script src="https://image.thehyundai.com/pc/js/jquery-1.11.3.min.js"></script>
<script src="https://image.thehyundai.com/pc/js/jquery-ui.min.js"></script>
<script src="https://image.thehyundai.com/pc/js/jquery-migrate.min.js"></script>
<script type="text/javascript">
	document.domain = "thehyundai.com";
	var locationHref = document.location.href;
	var imageServer = "https://image.thehyundai.com";
	var serverHost = "http://www.thehyundai.com";
	var serverHostForSSL = "https://www.thehyundai.com";

	var switch_serverHost;
	var contextPath = "/front";

	if (locationHref.indexOf("https") > -1) {
		switch_serverHost = serverHostForSSL;
	} else if (locationHref.indexOf("http") > -1) {
		switch_serverHost = serverHost;
	}

	var _timer;
	$(document).ready(
			function() {
				var interval = 1801000;
				var ChkSTDtm = new Date();
				var expireDtm = new Date();
				ChkSTDtm.setMinutes(ChkSTDtm.getMinutes() + 30);
				expireDtm.setDate(expireDtm.getDate() + 1);
				document.cookie = "ChkSTDtm=" + ChkSTDtm.getTime()
						+ "; path=/; expires=" + expireDtm.toUTCString()
						+ "; path=/";
				_timer = setTimeout("timeOutLogOutCookie()", interval);
			});

	function timeOutLogOut() {
		try {
			gfnSsoDscdToknReq(dscdCallback2);
		} catch (exception) {
			console.log(exception);
		} finally {
			location.href = "https://www.thehyundai.com/front/cob/logout.thd";
		}
	}
</script>

<script src="https://image.thehyundai.com/pc/js/plugin.js?ver=040213"></script>
<script type="text/javascript"
	src="https://image.thehyundai.com/pc/js/hdmall/co/jquery.form.js"></script>
<script type="text/javascript"
	src="https://image.thehyundai.com/pc/js/hdmall/co/default.js?ver=040213"></script>
<script type="text/javascript"
	src="https://image.thehyundai.com/pc/js/hdmall/co/common.js?ver=040213"></script>
<script src="https://image.thehyundai.com/pc/js/common.js?ver=040213"></script>
<script type="text/javascript"
	src="https://image.thehyundai.com/pc/js/swiper.min.js?ver=040213"></script>
<style type="text/css">
.fancybox-margin {
	margin-right: 17px;
}
</style>
<link rel="stylesheet" type="text/css"
	href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css" />
<style type="text/css">
.fancybox-margin {
	margin-right: 0px;
}
</style>
<style type="text/css">
.fancybox-margin {
	margin-right: 21px;
}
</style>
</head>

<body oncontextmenu="return false" ondragstart="return false"
	onselectstart="return false">
	<!-- wrap -->
	<div id="wrap" class="sub">
		<header id="header" th:insert="~{include/header}"></header>
		<!-- gnb -->

		<script type="text/javascript"
			src="https://www.thehyundai.com/js/hdmall/co/referCodes.js"></script>

		<!-- top banner -->
		<div id="js-tpl-topBanner" style="display: none"></div>

		<div class="top-wrap sub">
			<div class="top-area-setting">
				<script type="text/javascript"
					src="https://www.thehyundai.com/js/hdmall/dp/dpo/dqSearch.js?ver=040213"></script>

				<script type="text/javascript"
					src="https://www.thehyundai.com/js/hdmall/dp/dpo/dqAutoCompleteNewCommon.js?ver=040213"></script>
				<script type="text/javascript"
					src="https://www.thehyundai.com/js/hdmall/dp/dpo/dqAutoCompleteNew.js?ver=040213"></script>

				<!-- //header -->
			</div>
		</div>

		<!-- container -->
		<div id="container">
			<!-- content-wrap -->
			<div class="content-wrap hasleft myhyundai">
				<!-- left contents -->

				<div class="leftarea">
					<h2>
						<a href="/front/mpf/selectMyPageMain.thd">마이현대<span>MY
								HYUNDAI</span></a>
					</h2>
					<div class="line"></div>

					<!-- leftmenu -->
					<ul class="leftmenu">
						<li class=""><a class="not">MY Make-ON</a>
							<ul>
								<li class=""><a href="/mypage/reserv">예약 관리</a></li>
								<li class=""><a href="/mypage/reserv_done">예약 완료</a></li>
								<li class=""><a href="/mypage/reserv_ready">상담 입장</a></li>
								<li class=""><a href="/mypage/reserv_ing">상담 완료</a></li>
							</ul></li>
						<li class=""><a class="not">MY 피부 MBTI</a>
							<ul>
								<li class=""><a href="/mypage/skinmbti">결과 보기</a></li>
							</ul></li>
						<li class=""><a class="not">MY 주문</a>
							<ul>
								<li class=""><a href="/shop/orderlist">주문 내역</a></li>

							</ul></li>

					</ul>
					<!-- //leftmenu -->
				</div>
				<!-- //leftarea -->
				<!-- // left contents -->

				<!-- content -->
				<div class="content">
					<div class="myhyundai-head"></div>
					<div class="myhyundai-main"
						style="margin: 40px 0; font-family: 'notokr-medium';">
						<h3>Make-On 예약 관리</h3>
					</div>
					<!-- cart-list -->
					<div class="myhyundai-main"
						style="margin: 40px 0; font-family: 'notokr-demilight';">
						<h2>예약 결과</h2>
					</div>
					<div class="numbering"
						style="font-family: 'locator-medium'; position: relative; float: left; margin-right: 695px; line-height: 26px;">
						<p style="display: inline">예약번호 :</p>
						<p style="display: inline" th:text="${info.rid}"></p>
						<input type="hidden" class="mid" id="mid" name="mid" th:value="${info.mid}">
					</div>
					<div style="position: relative;">
						<p class="v-btn-wrap" style="">
							<a th:href="'/mypage/result2?rid=' + ${info.rid}"
								onclick="javascript:GA_Event('PC_마이페이지', '최근_주문_배송내역', '상세내역');"
								class="btn color4 size1"
								style="background: #bfae90; border: #bfae90;">상세 결과</a>
						</p>
					</div>
					<div>
						<div class="makeupwrapper" style="margin-bottom: 100px;">
							<!-- 예약자 정보 -->
							<div class="table-wrap order-addinfo mt20">
								<table>
									<caption></caption>
									<colgroup>
										<col style="width: 150px;">
										<col style="width: 690px;">
									</colgroup>
									<tbody>
										<tr>
											<th scope="row">예약자</th>
											<td colspan="3" th:text="${mem.mName}"></td>
										</tr>
										<tr>
											<th scope="row">상담일자</th>
											<td th:text="${info.rdate}"></td>
										</tr>
										<tr>
											<th scope="row">피부 MBTI</th>
											<td th:text="${pro.mbti}"></td>
										</tr>

										<tr>
											<th scope="row">담당 ARTIST</th>
											<td colspan="3">박성환</td>
										</tr>
										<!-- 주문시 요청사항 배송기사님 -->

										<tr>
											<th scope="row">요청 사항</th>
											<td th:text="${info.rneeds}">></td>
										</tr>
										<tr>
											<th scope="row">아티스트 당부 사항</th>
											<td colspan="3" th:text="${result.artistcmt}"></td>
										</tr>

									</tbody>
								</table>
							</div>
							<!-- 예약자 정보 -->
							<!-- color 정보 -->
							<div class="table-wrap order-addinfo mt20">
								<table>
									<caption></caption>
									<colgroup>
										<col style="width: 33%;">

										<col style="width: 33%;">
										<col style="width: 33%;">
									</colgroup>
									<tbody>
										<tr style="font-family: 'notokr-medium';">
											<td style="text-align: center;">LIP</td>
											<td style="text-align: center;">BLUSH</td>
											<td style="text-align: center;">FOUNDATION</td>
										</tr>
										<tr>
											<td style="text-align: center;" th:text="${result.lip}"></td>
											<td style="text-align: center;" th:text="${result.blush}"></td>
											<td style="text-align: center;" th:text="${result.face}"></td>
										</tr>
									</tbody>
								</table>
							</div>
							<!-- color 정보 -->
							<!-- before after -->
							<div class="numbering"
								style="text-align: center; margin: 20px; font-family: 'notokr-demilight'; font-size: initial;">
								<p style="">결과 사진</p>
							</div>
							<div class="wrapper3"
								style="grid-template-columns: repeat(2, 1fr); display: grid; place-items: center; margin: 0 50px;">
								<div class="faceupload" style="float: left">
									<img class="face"
										th:src="'/beauty/display?fileName=' + ${info.rimg}"
										style="max-width: 300px; margin: 0 20 20 20; float: right;">
								</div>
								<div class="faceupload" style="float: left">
									<img class="face" th:src="${result.result_img}"
										style="max-width: 300px; margin: 0 20 20 20">
								</div>
								<div style="text-align: center">
									<span style="font-family: 'locator-regular';">BEFORE</span>
								</div>
								<div style="font-family: 'locator-regular';">
									<span>AFTER</span>
								</div>
							</div>
							<!-- before after -->
							<div class="selectprod">
								<div class="numbering"
									style="margin: 20px 0; text-align: center">
									<p
										style="text-align: center; font-weight: bold; font-family: 'notokr-demilight'; font-size: initial;">
										ARTIST's PICK</p>
								</div>
									<div class="lip_prod">
										<div class="product-list-wrap1" style="width: fit-content">
											<div class="select-list" style="width: auto;">
												<div style="margin-bottom: 10px">
													<p>Lip</p>
												</div>
												<div style="margin-bottom: 10px">
													<p>Blush</p>
												</div>
												<div style="margin-bottom: 10px">
													<p>Foundation</p>
												</div>

											</div>
											<div class="finalproduct">
											<section class="product_wrap">

												<!-- 신상, 단독구성 -->
												<ul class="product_list ea03" id="listUl">
													<li style="margin: 0 0 20px 16px;"><a
														th:href="'/product/detail?code=' + ${lipresult.pcode}">
															<img th:src="${lipresult.iloc} + '_600.jpg'"
															th:alt="${lipresult.pname}"> <input type="hidden"
															name="pcode" class="pcode"
															th:value="${lipresult.pcode}" /> <input type="hidden"
															name="opt" class="opt"
															th:value="${lipresult.optname}" /> <input type="hidden"
															name="price" class="price" th:value="${lipresult.pprice}" />
															<input type="hidden" name="pname" class="pname"
															th:value="${lipresult.pname}" /> <input type="hidden"
															name="brand" class="brand" th:value="${lipresult.bname}" />
															<input type="hidden" name="imglink" class="imglink"
															th:value="${lipresult.iloc} + '_600.jpg'" /> <input
															type="hidden" name="rate" class="rate" value="4.5" /> <input
															type="hidden" name="review" class="review" value=" " />
															<input type="hidden" name="pVolume" class="pVolume"
															th:value="${lipresult.pvolume}" /> <input
															type="hidden" name="ptype" class="ptype"
															th:value="${lipresult.ptype}" /> <input
															type="hidden" name="pingredient" class="pingredient"
															th:value="${lipresult.pingredient}" /> <span
															class="hash_tag" th:text="${lipresult.bname}"></span> <span
															class="tit" th:text="${lipresult.pname}"
															style="height: 54px;"></span> <span class="kind"
															th:text="${lipresult.optname}"></span> <span
															class="rating"> </span> <span class="price"> <span
																class="after">[[${#numbers.formatInteger(lipresult.pprice,
																	3, 'COMMA')}]]<em>원</em>


															</span>
														</span>
													</a>
														<div class="over">
															<button class="detailview" onclick="put()">비교함
																담기</button>
															<button data-price="${lipresult.pprice}"
																data-linename="${lipresult.pname}"
																data-sapcode="${lipresult.pname}" data-category="20"
																class="addcart basket" onclick="addCart()">장바구니
																담기</button>
														</div></li>
														
														
													<li class="" style="margin: 0 0 20px 16px;"><a
														th:href="'/product/detail?code=' + ${blushresult.pcode}">
														<img th:src="${blushresult.iloc} + '_600.jpg'"
															th:alt="${blushresult.pname}"> <input type="hidden"
															name="pcode" class="pcode"
															th:value="${blushresult.pcode}" /> <input type="hidden"
															name="opt" class="opt"
															th:value="${blushresult.optname}" /> <input type="hidden"
															name="price" class="price" th:value="${blushresult.pprice}" />
															<input type="hidden" name="pname" class="pname"
															th:value="${blushresult.pname}" /> <input type="hidden"
															name="brand" class="brand" th:value="${blushresult.bname}" />
															<input type="hidden" name="imglink" class="imglink"
															th:value="${blushresult.iloc} + '_600.jpg'" /> <input
															type="hidden" name="rate" class="rate" value="4.5" /> <input
															type="hidden" name="review" class="review" value=" " />
															<input type="hidden" name="pVolume" class="pVolume"
															th:value="${blushresult.pvolume}" /> <input
															type="hidden" name="ptype" class="ptype"
															th:value="${blushresult.ptype}" /> <input
															type="hidden" name="pingredient" class="pingredient"
															th:value="${blushresult.pingredient}" /> <span
															class="hash_tag" th:text="${blushresult.bname}"></span> <span
															class="tit" th:text="${blushresult.pname}"
															style="height: 54px;"></span> <span class="kind"
															th:text="${blushresult.optname}"></span> <span
															class="rating"> </span> <span class="price"> <span
																class="after">[[${#numbers.formatInteger(blushresult.pprice,
																	3, 'COMMA')}]]<em>원</em>


															</span>
														</span>
													</a>
														<div class="over">
															<button class="detailview" onclick="put()">비교함
																담기</button>
															<button data-price="${blushresult.pprice}"
																data-linename="${blushresult.pname}"
																data-sapcode="${blushresult.pname}" data-category="20"
																class="addcart basket" onclick="addCart()">장바구니
																담기</button>
														</div></li>
														
														
													<li style="margin: 0 0 20px 16px;"><a
														th:href="'/product/detail?code=' + ${faceresult.pcode}">
														<img th:src="${faceresult.iloc} + '_600.jpg'"
															th:alt="${faceresult.pname}"> <input type="hidden"
															name="pcode" class="pcode"
															th:value="${faceresult.pcode}" /> <input type="hidden"
															name="opt" class="opt"
															th:value="${faceresult.optname}" /> <input type="hidden"
															name="price" class="price" th:value="${faceresult.pprice}" />
															<input type="hidden" name="pname" class="pname"
															th:value="${faceresult.pname}" /> <input type="hidden"
															name="brand" class="brand" th:value="${faceresult.bname}" />
															<input type="hidden" name="imglink" class="imglink"
															th:value="${faceresult.iloc} + '_600.jpg'" /> <input
															type="hidden" name="rate" class="rate" value="4.5" /> <input
															type="hidden" name="review" class="review" value=" " />
															<input type="hidden" name="pVolume" class="pVolume"
															th:value="${faceresult.pvolume}" /> <input
															type="hidden" name="ptype" class="ptype"
															th:value="${faceresult.ptype}" /> <input
															type="hidden" name="pingredient" class="pingredient"
															th:value="${faceresult.pingredient}" /> <span
															class="hash_tag" th:text="${faceresult.bname}"></span> <span
															class="tit" th:text="${faceresult.pname}"
															style="height: 54px;"></span> <span class="kind"
															th:text="${faceresult.optname}"></span> <span
															class="rating"> </span> <span class="price"> <span
																class="after">[[${#numbers.formatInteger(faceresult.pprice,
																	3, 'COMMA')}]]<em>원</em>


															</span>
														</span>
													</a>
														<div class="over">
															<button class="detailview" onclick="put()">비교함
																담기</button>
															<button data-price="${faceresult.pprice}"
																data-linename="${faceresult.pname}"
																data-sapcode="${faceresult.pname}" data-category="20"
																class="addcart basket" onclick="addCart()">장바구니
																담기</button>
														</div></li>

												</ul>
											</section>
											<div class="btn_green"
												style="text-align: center; margin-top: 10px">
												<p class="pickbtn" onclick="addallCart()" style="line-height: 30px">전체 장바구니 담기
												</p>
											</div>
											</div>
										</div>
									</div>
							</div>
						</div>
					</div>

					<!-- //cart-list -->

					<!-- //입장-->
				</div>
				<!-- //content -->
			</div>
			<!-- //content-wrap -->
		</div>
		<div class="include-footer" th:insert="~{include/footer2}"></div>
	</div>
	<!-- //wrap -->
<script>	
function addallCart() {
	  console.log('장바구니 담기');

	  const clickedButton = event.currentTarget;
	  console.log(clickedButton);
	  const abc = clickedButton.closest('div');
	  console.log(abc);
	  const cde = abc.closest('.finalproduct');
	  console.log(cde);
	  const productList = cde.querySelectorAll('section #listUl li');
	  console.log(productList);
	  const selectedProducts = [];
	  const mid = document.getElementById('mid').value;

	  
	  for (let i = 0; i < productList.length; i++) {
		    const productItem = productList[i];
		    const pCode = productItem.querySelector('a .pcode').value;
		    const pOption = productItem.querySelector('a .opt').value;
		    const pAmount = 1;
		    const pname = productItem.querySelector('a .pname').value;

		    console.log(productList);

		    const requestData = JSON.stringify({
		      pcode: pCode,
		      poption: pOption,
		      pamount: pAmount,
		      mid: mid
		    });

		    //로그인 여부 확인 
		    //중복 상품 확인

		    console.log(requestData);

		    if (mid !== 'anonymousUser') {
		    	
		   		const lastIndex = i === productList.length - 1;
		      $.ajax({
		        url: '/restcart/addCart',
		        type: 'post',
		        data: requestData,
		        contentType: "application/json",
		        success: function(result) {
		          console.log("장바구니 success");
		          if (result == '0') {
		            alert("장바구니에 추가를 하지 못하였습니다.");
		          } else if (result == '1' && lastIndex ) {
		            alert("장바구니에 추가되었습니다.");
		          } else if (result == '2' && lastIndex ) {
		            alert("이미 장바구니에 담긴 상품으로 수량이 추가되었습니다.");
		          }
		        },
		        error: function(request, status, error) {
		          console.log(error);
		        }
		      });
		    } else {
		      console.log("로그인 필요");
		      alert('장바구니는 로그인이 필요합니다.');
		      var loginUrl = "/member/login";
		      window.location.href = loginUrl;
		    }
		  }
		}

	</script>
	<script>
	function put() {
	    const clickedButton = event.currentTarget;
	    const clickedLi = clickedButton.closest('li');
	    
	    const pcode = clickedLi.querySelector(".pcode").value;
	    const opt = clickedLi.querySelector(".opt").value;
	    const price = clickedLi.querySelector(".price").value;
	    const pname = clickedLi.querySelector(".pname").value;
	    const brand = clickedLi.querySelector(".brand").value;
	    const imglink = clickedLi.querySelector(".imglink").value;
	    const rate = clickedLi.querySelector(".rate").value;
	    const review = clickedLi.querySelector(".review").value;
	    const pVolume = clickedLi.querySelector(".pVolume").value;
	    const ptype = clickedLi.querySelector(".ptype").value;
	    const pingredient = clickedLi.querySelector(".pingredient").value;
	    
	    console.log(pcode);
	    console.log(pname);

	    let arr = JSON.parse(localStorage.getItem("arr")) || []; // null일 경우 빈 배열 생성

	    if (arr.length >= 10) {
	        alert("비교함에는 10개의 상품을 담을 수 있습니다.");
	        return false;
	    }

	    if (arr.some(item => item[0] === pcode)) { // 이미 비교함에 추가된 상품인 경우
	        alert("이미 비교함에 담긴 상품입니다.");
	    } else {
	        arr.push([pcode, pname, brand, price, imglink, rate, review, pVolume, ptype, pingredient]); // 상품 정보 저장
	        localStorage.setItem("arr", JSON.stringify(arr));
	        alert("비교함에 담겼습니다.");
	    }
	    console.log("비교함에 담음");

	    // show the content of the corresponding li element
	    const content = clickedLi.textContent.trim();
	    console.log("The content of the corresponding li element is:", content);
	    //담았으면 옆에 사이드바에 띄워줘야 함
	}
</script>

	<script>
	function addCart() {
		console.log('장바구니 담기');
		const clickedButton = event.currentTarget;
		const clickedLi = clickedButton.closest('li');
		var pCode = clickedLi.querySelector(".pcode").value;
		var pOption = clickedLi.querySelector(".opt").value;
		var pAmount = 1;
		var mid = document.getElementById('mid').value;
		console.log(mid);
		const pname = clickedLi.querySelector(".pname").value;
    console.log(pname+" 이름");

		console.log(pOption);
		
		if (mid !='anonymousUser'){
			var requestData = JSON.stringify({
				pcode : pCode,
				poption : pOption,
			  pamount : pAmount,
			  mid  :mid
		});
		//로그인 여부 확인 
		//중복 상품 확인
		
		console.log(requestData);

		 $.ajax({
			url: '/restcart/addCart',
			type: 'post',
			data: requestData,
			contentType: "application/json",
			success	: function(result){
				console.log("장바구니 success");
				if(result == '0'){
					alert("장바구니에 추가를 하지 못하였습니다.");
				} else if(result == '1'){
					alert("장바구니에 추가되었습니다.");
				} else if(result == '2'){
					alert("이미 장바구니에 담긴 상품으로 수량이 추가되었습니다.");
				} 
			},
			error :function(request, status, error) {
				console.log(error);
			}
		}); 
		}else {
			console.log("로그인 필요");
			alert('장바구니는 로그인이 필요합니다.');
			var loginUrl = "/member/login";
			window.location.href = loginUrl;
		}
		
	}
	</script>
	<style>
button.addcart.basket {
	background: url(/img/cart.png) !important;
	width: 56px !important;
	height: 56px !important;
	background-size: 56px !important;
}

button.detailview {
	background-image: url(/img/plus.png) !important;
	width: 56px !important;
	height: 56px !important;
	background-size: 56px !important;
	background: rgba(0, 0, 0, 0) !important;
	border-radius: 50px !important;
}

.product_wrap .product_list .over button:first-child {
	background-image: url(/img/plus.png) !important;
	background-size: 56px !important;
	opacity: 0.85;
}
</style>
</body>
</html>
